<html>
<head>
<title>Web App</title>

<script src="https://www.gstatic.com/firebasejs/5.8.1/firebase.js"></script>
<script>
	// Initialize Firebase
	var config = {
		apiKey: "AIzaSyDkJap-l-nEEa8_Up_fRyBKadFLO8PzKQM",
		authDomain: "miraclemessages-v2.firebaseapp.com",
		databaseURL: "https://miraclemessages-v2.firebaseio.com",
		projectId: "miraclemessages-v2",
		storageBucket: "miraclemessages-v2.appspot.com",
		messagingSenderId: "669586730683"
	};
	var app = firebase.initializeApp(config);
</script>

</head>
<body>

<script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-database.js"></script>

<script lang="text/javascript">

var auth = app.auth();
var isAdmin = false;

// Check if a user is signed in - only allow access to the page if they are
// If not logged, redirect to the login page
auth.onAuthStateChanged(function(user) {
	// If a user is signed in, log it
	if (user) {
		console.log(user)
	} 

	// Otherwise, alert the user they're not logged in and redirect to login page
	else {
		alert("not logged in");
		window.location.href = 'index.html';
	}
});

// Functions to take you to various pages when the admin clicks on the
// various page buttons

// Takes you to volunteer's associated cases
function visitCases(){
	window.location='volunteerCases.html';
}

// Takes you to Miracle Message's add cases page
function visitAdd(){
	window.location='https://miraclemessages.org/refer';
}

// Check for a successful sign out and redirect the user to login page
function signoutGood() {
	const user = data.user;

  // Check to make sure no user is currently signed in - if so, redirect to
  // the login page
  if (user == null) {
  	alert ("Successfully signed out");
  	window.location.href = "index.html";
  }
}

// Handle an unsuccessful signout
function signoutError(error){
	// Get the error message and alert the user
	var errorCode = error.code;
	var errorMessage = error.message;
	alert(error.message);
}

// Signs out the current user 
function signout(){
  // If can sign out without error, call signoutGood()
  // Otherwise, handle any errors in signoutError()
  auth.signOut().catch(signoutError).then(signoutGood);
}

</script>

	<!-- Buttons to navigate to different pages -->
	<button type="button" id="search" onclick="visitAdd()">Add</button>
	<button type="button" id="add" onclick="visitCases()">Cases</button>
	<button type="button" id="sign out" onclick="signout()">Sign Out</button>

</body>
</html>
