<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Miracle Messages Web App</title>
  <link rel="shortcut icon" href="mm-logo.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
  <link rel="stylesheet" href="bundle-login.css">

  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDkJap-l-nEEa8_Up_fRyBKadFLO8PzKQM",
      authDomain: "miraclemessages-v2.firebaseapp.com",
      databaseURL: "https://miraclemessages-v2.firebaseio.com",
      projectId: "miraclemessages-v2",
      storageBucket: "miraclemessages-v2.appspot.com",
      messagingSenderId: "669586730683"
    };
    var app = firebase.initializeApp(config);
  </script>

  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-database.js"></script>

  <script lang="text/javascript">
  var auth = app.auth();
  var isAdmin = false;
  var pwd = document.getElementById("password-input");

  function signin_good(data){
    const user = data.user;

    // this function might get hit twice, first with user null
    // if (user != null && user.uid.equals('5NGsBgjCngOZmX7ANHCM9r63xfD2'))
    if (user != null && user.uid === '5NGsBgjCngOZmX7ANHCM9r63xfD2')
        window.location.href = "home.html";
    else {
        window.location.href = "home.html";
    }
  }

  function signin_catch(error){
    var errorCode = error.code;
    var errorMessage = error.message;
    alert(errorMessage);
  }

  function signin(){
    var email = document.getElementById("email-input").value;
    var pword = document.getElementById("password-input").value;
    auth.signInWithEmailAndPassword(email, pword).catch(signin_catch).then(signin_good);
    auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(
      function(){return auth.signInWithEmailAndPassword(email,pword).catch(signin_catch);});
  }
  </script>

</head>

<body class="mm-login">
  <section class="header">
    <svg class="mm-logo" version="1.0" xmlns="http://www.w3.org/2000/svg"
   width="225.000000pt" height="100pt" viewBox="0 0 225.000000 225.000000"
   preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,250.000000) scale(0.100000,-0.100000)"
    fill="#000000" stroke="none">
    <path d="M725 1500 l-399 -400 39 -40 39 -40 56 55 c31 30 59 55 63 55 4 0 7
    -151 7 -335 l0 -335 595 0 595 0 0 335 c0 184 3 335 7 335 4 0 32 -25 63 -55
    l56 -55 39 40 40 40 -400 400 -400 400 -400 -400z m605 35 l195 -195 -400 0
    -400 0 195 195 c107 107 199 195 205 195 6 0 98 -88 205 -195z m-3 -512 l-197
    -198 -197 198 -198 197 395 0 395 0 -198 -197z m33 -128 c129 129 238 235 242
    235 5 0 8 -124 8 -275 l0 -275 -480 0 -480 0 0 277 0 278 238 -238 237 -237
    235 235z"/>
    </g>
  </svg>
    <h1>MIRACLE MESSAGES</h1>
  </section>

  <form id="mm-login-form" action="javascript:signin()">
    <div class="mdc-text-field username">
      <input type="text" class="mdc-text-field__input" id="email-input" name="email" required>
      <label class="mdc-floating-label" for="email-input">Email</label>
      <div class="mdc-line-ripple"></div>
    </div>
    <div class="mdc-text-field password">
      <input type="password" class="mdc-text-field__input" id="password-input" name="password" required>
      <label class="mdc-floating-label" for="password-input">Password</label>
      <div class="mdc-line-ripple"></div>
    </div>

    <div class="button-container">
      <button type="button" class="mdc-button cancel">
        <span class="mdc-button__label">
          Cancel
        </span>
      </button>
      <button class="mdc-button mdc-button--raised next">
        <span class="mdc-button__label">
          Next
        </span>
      </button>
    </div>
  </form>

  <script src="bundle-login.js" async></script>
</body>
</html>
